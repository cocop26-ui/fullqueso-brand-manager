rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // Helper function to check if user is authenticated
    function isAuthenticated() {
      return request.auth != null;
    }

    // Helper function to check if user is admin
    // You can enhance this later with a custom claims or admin collection
    function isAdmin() {
      return isAuthenticated();
    }

    // Clientes Bot Collection
    match /clientes_bot/{clienteId} {
      // Admins can read all customer data
      allow read: if isAdmin();

      // Only allow writes through Cloud Functions
      // Admins should not directly modify customer data
      allow write: if false;
    }

    // Pedidos Bot Collection
    match /pedidos_bot/{pedidoId} {
      // Admins can read all orders
      allow read: if isAdmin();

      // Only allow writes through Cloud Functions
      allow write: if false;
    }

    // Conversaciones Bot Collection
    match /conversaciones_bot/{conversacionId} {
      // Admins can read all conversations
      allow read: if isAdmin();

      // Only allow writes through Cloud Functions
      allow write: if false;
    }

    // Deny all other collections by default
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
